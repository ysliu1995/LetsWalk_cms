(this.webpackJsonpletwalk_cms=this.webpackJsonpletwalk_cms||[]).push([[0],{100:function(e,t,a){},101:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(8),l=a.n(o),s=(a(93),a(45)),c=a(175),i=a(183),u=a(177),m=a(176),f=a(178),h=a(156),p=a(24),d=a(180),g=a(157),E=a(179),v=a(158),b=a(78),y=a.n(b),I=a(26),O=a(27),k=a(30),w=a(29),j=a(19),S=a(152),C=a(65),x=a(102),R=a(159);function A(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=Object(j.a)(e);if(t){var r=Object(j.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(w.a)(this,a)}}r.a.Component;var D=a(182),F=a(36);function N(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=Object(j.a)(e);if(t){var r=Object(j.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(w.a)(this,a)}}var L=function(e){Object(k.a)(a,e);var t=N(a);function a(){var e;Object(I.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={roomInfo:[],userInfo:[],message:[],open:!1},e}return Object(O.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.setState({open:!0}),fetch("https://us-central1-letswalk-c0e21.cloudfunctions.net/GetAllRoomInfo").then((function(e){return e.json()})).then((function(t){e.setState({roomInfo:JSON.parse(t).room,userInfo:JSON.parse(t).users}),console.log(e.state.roomInfo),console.log(e.state.userInfo),e.setState({open:!1})})).catch(console.log)}},{key:"render",value:function(){var e=[];if(0!==this.state.roomInfo.length)for(var t=this.state.roomInfo.length,a=0;a<t;a++)e.push(r.a.createElement(S.a,{item:!0,xs:3},r.a.createElement(C.a,null,r.a.createElement(h.a,null,r.a.createElement(g.a,{button:!0,component:F.b,to:{pathname:"/teaminfo",state:{roomId:this.state.roomInfo[a].id,userInfo:this.state.userInfo,user1:this.state.roomInfo[a].user[0],user2:this.state.roomInfo[a].user[1]}}},r.a.createElement(v.a,null,this.state.userInfo[this.state.roomInfo[a].user[0]]," & ",this.state.userInfo[this.state.roomInfo[a].user[1]]),1===this.state.roomInfo[a].active?r.a.createElement(v.a,{style:{backgroundColor:"#37ABA2",textAlign:"center",color:"#FFFFFF"}},"\u7d44\u968a\u4e2d"):r.a.createElement(v.a,{style:{backgroundColor:"#FF5151",textAlign:"center",color:"#FFFFFF"}},"\u5df2\u89e3\u9664"))))));return r.a.createElement("div",null,r.a.createElement(S.a,{container:!0,spacing:5},r.a.createElement(S.a,{item:!0,xs:12},r.a.createElement(D.a,{"aria-label":"breadcrumb"},r.a.createElement(p.a,{color:"textPrimary"},"\u968a\u4f0d\u5217\u8868"))),r.a.createElement(S.a,{item:!0,xs:12},r.a.createElement(S.a,{container:!0,spacing:3},e))),r.a.createElement(x.a,{style:{color:"#fff"},open:this.state.open},r.a.createElement(R.a,{color:"inherit"})))}}]),a}(r.a.Component),P=a(163),B=a(165),J=a(160),U=a(164),T=a(161),G=a(4),M=a(166),W=a(77),z=a.n(W),_=a(181),H=a(167),$=a(171),q=a(169),K=a(170),Q=a(168),V=a(162);function X(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=Object(j.a)(e);if(t){var r=Object(j.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(w.a)(this,a)}}var Y={padding:"50px"},Z=Object(G.a)((function(e){return{head:{backgroundColor:"#37ABA2",color:e.palette.common.white},body:{fontSize:14}}}))(J.a),ee=function(e){Object(k.a)(a,e);var t=X(a);function a(){var e;Object(I.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={roomId:"",roomInfo:[],userInfo:[],message:[],stepInfo:[],user1:"",user2:"",open:!1,content:"",progressOpen:!1},e.handleClickOpen=function(){e.setState({open:!0})},e.handleClickClose=function(){e.setState({open:!1})},e.handleClose=function(){e.setState({open:!1,progressOpen:!0}),console.log(e.state.content),console.log("\u4e0a\u50b3");var t=new URL("https://us-central1-letswalk-c0e21.cloudfunctions.net/SendContentToRoom"),a={room:e.state.roomId,content:e.state.content};Object.keys(a).forEach((function(e){return t.searchParams.append(e,a[e])})),fetch(t).then((function(e){return e.json()})).then((function(t){console.log(t),console.log("\u4e0b\u8f09");var a=new URL("https://us-central1-letswalk-c0e21.cloudfunctions.net/GetRoomInfo"),n={room:e.state.roomId};Object.keys(n).forEach((function(e){return a.searchParams.append(e,n[e])})),fetch(a).then((function(e){return e.json()})).then((function(t){e.setState({message:JSON.parse(t).message,stepInfo:JSON.parse(t).stepData[0],progressOpen:!1}),console.log(e.state.stepInfo)})).catch(console.log)})).catch(console.log)},e.handleChange=function(t){e.setState({content:t.target.value})},e.download=function(){var t="";t+="Data,StepGoal,TotalStep,"+e.state.userInfo[e.state.user1]+","+e.state.userInfo[e.state.user2]+"\r\n";for(var a=0,n=Object.entries(e.state.stepInfo);a<n.length;a++){var r=Object(s.a)(n[a],2),o=r[0],l=r[1];t+=o+","+l.TotalStep+","+l.teamStep+","+l[e.state.user1]+","+l[e.state.user2]+"\r\n"}console.log("\u5132\u5b58\u6b65\u6578\u8cc7\u8a0a");var c=document.createElement("a"),i=new Blob([t]);c.href=URL.createObjectURL(i),c.download="step("+e.state.userInfo[e.state.user1]+"-"+e.state.userInfo[e.state.user2]+").csv",document.body.appendChild(c),c.click();var u="";u+="sender,message\r\n";for(var m=0,f=Object.entries(e.state.message);m<f.length;m++){var h=Object(s.a)(f[m],2),p=(h[0],h[1]);"admin"===p.sender?u+="admin,"+p.message+"\r\n":u+=e.state.userInfo[p.sender]+","+p.message+"\r\n"}console.log("\u5132\u5b58\u804a\u5929\u5ba4\u5167\u5bb9");var d=document.createElement("a"),g=new Blob([u]);d.href=URL.createObjectURL(g),d.download="chat("+e.state.userInfo[e.state.user1]+"-"+e.state.userInfo[e.state.user2]+").csv",document.body.appendChild(d),d.click()},e}return Object(O.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.location.state.roomId,a=this.props.location.state.userInfo,n=this.props.location.state.user1,r=this.props.location.state.user2;this.setState({roomId:t,userInfo:a,user1:n,user2:r,progressOpen:!0}),console.log(t),console.log(a),console.log("\u4e0b\u8f09");var o=new URL("https://us-central1-letswalk-c0e21.cloudfunctions.net/GetRoomInfo"),l={room:t};Object.keys(l).forEach((function(e){return o.searchParams.append(e,l[e])})),fetch(o).then((function(e){return e.json()})).then((function(t){e.setState({message:JSON.parse(t).message,stepInfo:JSON.parse(t).stepData[0],progressOpen:!1}),console.log(e.state.stepInfo)})).catch(console.log)}},{key:"render",value:function(){for(var e=this,t=[],a=0,n=Object.entries(this.state.stepInfo);a<n.length;a++){var o=Object(s.a)(n[a],2),l=o[0],c=o[1];console.log(l,c),t.push(r.a.createElement(T.a,null,r.a.createElement(Z,{align:"center"},l),r.a.createElement(Z,{align:"center"},c.TotalStep),r.a.createElement(Z,{align:"center"},c.teamStep),r.a.createElement(Z,{align:"center"},c[this.state.user1]),r.a.createElement(Z,{align:"center"},c[this.state.user2])))}return console.log(t),r.a.createElement("div",null,r.a.createElement(S.a,{container:!0,spacing:5},r.a.createElement(S.a,{item:!0,xs:10},r.a.createElement(D.a,{"aria-label":"breadcrumb"},r.a.createElement(p.a,{component:F.b,color:"inherit",to:"/teamlist"},"\u968a\u4f0d\u5217\u8868"),r.a.createElement(p.a,{color:"textPrimary"},"\u968a\u4f0d\u8cc7\u8a0a( ",this.state.userInfo[this.state.user1]," - ",this.state.userInfo[this.state.user2],")"))),r.a.createElement(S.a,{item:!0,xs:2},r.a.createElement(V.a,{variant:"contained",onClick:this.download,color:"primary",style:{align:"right",backgroundColor:"#37ABA2"}},"\u5132\u5b58\u6a94\u6848")),r.a.createElement(S.a,{item:!0,xs:6},r.a.createElement(P.a,{style:Y},r.a.createElement(U.a,null,r.a.createElement(T.a,null,r.a.createElement(Z,{align:"center"},"Date"),r.a.createElement(Z,{align:"center"},"Step Goal"),r.a.createElement(Z,{align:"center"},"total steps"),r.a.createElement(Z,{align:"center"},this.state.userInfo[this.state.user1],"'s steps"),r.a.createElement(Z,{align:"center"},this.state.userInfo[this.state.user2],"'s steps"))),r.a.createElement(B.a,null,t))),r.a.createElement(S.a,{item:!0,xs:6},r.a.createElement(C.a,{style:{maxHeight:450,overflow:"auto"}},r.a.createElement(h.a,null,this.state.message.map((function(t,a,n){return r.a.createElement(g.a,null,"admin"===e.state.message[a].sender?r.a.createElement(v.a,null,"admin : ",e.state.message[a].message):r.a.createElement(v.a,null,e.state.userInfo[e.state.message[a].sender]," : ",e.state.message[a].message))})))),r.a.createElement(M.a,{color:"primary","aria-label":"add",onClick:this.handleClickOpen,style:{backgroundColor:"#37ABA2",right:"20px",bottom:"10px",left:"auto",position:"absolute"}},r.a.createElement(z.a,null)),r.a.createElement(H.a,{open:this.state.open,onClose:this.handleClose,"aria-labelledby":"form-dialog-title"},r.a.createElement(Q.a,{id:"form-dialog-title"},"Let's Walk"),r.a.createElement(q.a,null,r.a.createElement(K.a,null,"\u50b3\u9001\u8a0a\u606f\u81f3\u804a\u5929\u5ba4"),r.a.createElement(_.a,{autoFocus:!0,margin:"dense",value:this.state.content,onChange:this.handleChange,label:"\u8981\u8aaa\u7684\u8a71...",fullWidth:!0})),r.a.createElement($.a,null,r.a.createElement(V.a,{onClick:this.handleClickClose,color:"primary"},"\u53d6\u6d88"),r.a.createElement(V.a,{onClick:this.handleClose,color:"primary"},"\u78ba\u8a8d"))))),r.a.createElement(x.a,{style:{color:"#fff"},open:this.state.open},r.a.createElement(R.a,{color:"inherit"})))}}]),a}(r.a.Component),te=a(174),ae=a(184),ne=a(172),re=a(173);function oe(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=Object(j.a)(e);if(t){var r=Object(j.a)(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return Object(w.a)(this,a)}}var le=function(e){Object(k.a)(a,e);var t=oe(a);function a(){var e;Object(I.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={userinfo:[],left:[],right:[],message:""},e.handleToggle=function(t,a){return function(){var n=e.state.left,r=e.state.right;if("left"===a){var o=e.state.left.indexOf(t);n.splice(o,1),r.push(t)}else{var l=e.state.right.indexOf(t);r.splice(l,1),n.push(t)}e.setState({right:r,left:n})}},e.handleAllRight=function(){var t=e.state.right.concat(e.state.left);e.setState({right:t,left:[]})},e.handleAllLeft=function(){var t=e.state.left.concat(e.state.right);e.setState({right:[],left:t})},e.sendMessage=function(){for(var t=e.state.right,a=[],n=e.state.message,r=0;r<t.length;r++)a.push(e.state.userinfo.userinfo[t[r]].fcmtoken);console.log(a),console.log(n);var o=new URL("https://us-central1-letswalk-c0e21.cloudfunctions.net/SendToClient"),l={users:a,message:n};Object.keys(l).forEach((function(e){return o.searchParams.append(e,l[e])})),fetch(o).then((function(e){return e.json()})).then((function(e){console.log(e)})).catch(console.log)},e}return Object(O.a)(a,[{key:"componentDidMount",value:function(){var e=this;fetch("https://us-central1-letswalk-c0e21.cloudfunctions.net/GetAllUserInfo").then((function(e){return e.json()})).then((function(t){e.setState({userinfo:JSON.parse(t)}),console.log(e.state.userinfo.userinfo);var a=[];for(var n in e.state.userinfo.userinfo)a.push(n);e.setState({left:a})})).catch(console.log)}},{key:"render",value:function(){var e=this;return r.a.createElement(S.a,{container:!0,spacing:1,justify:"center",alignItems:"center"},r.a.createElement(S.a,{item:!0,xs:2},r.a.createElement(ne.a,{style:{width:200,height:600,overflow:"auto"}},r.a.createElement(re.a,{title:"\u5c1a\u672a\u9078\u64c7"}),this.state.left.map((function(t){return r.a.createElement(h.a,null,r.a.createElement(g.a,{button:!0,onClick:e.handleToggle(t,"left")},r.a.createElement(te.a,null,r.a.createElement(ae.a,null)),r.a.createElement(v.a,null,e.state.userinfo.userinfo[t].name)))})))),r.a.createElement(S.a,{item:!0,xs:1},r.a.createElement(S.a,{container:!0,direction:"column",alignItems:"center"},r.a.createElement(V.a,{variant:"outlined",size:"small",onClick:this.handleAllRight},"\u226b"),r.a.createElement(V.a,{variant:"outlined",size:"small",onClick:this.handleAllLeft},"\u226a"))),r.a.createElement(S.a,{item:!0,xs:2},r.a.createElement(ne.a,{style:{width:200,height:600,overflow:"auto"}},r.a.createElement(re.a,{title:"\u5df2\u9078\u64c7"}),this.state.right.map((function(t){return r.a.createElement(h.a,null,r.a.createElement(g.a,{button:!0,onClick:e.handleToggle(t,"right")},r.a.createElement(te.a,null,r.a.createElement(ae.a,null)),r.a.createElement(v.a,null,e.state.userinfo.userinfo[t].name)))})))),r.a.createElement(S.a,{item:!0,xs:2}),r.a.createElement(S.a,{item:!0,xs:5},r.a.createElement("div",{align:"center"},r.a.createElement(_.a,{style:{width:400},multiline:!0,rows:"10",variant:"outlined",value:this.state.message,onChange:function(t){return e.setState({message:t.target.value})}})),r.a.createElement("p",null),r.a.createElement("div",{align:"center"},r.a.createElement(V.a,{variant:"contained",color:"primary",onClick:this.sendMessage},"Send notification"))))}}]),a}(r.a.Component),se=a(32),ce=Object(c.a)((function(e){return{root:{display:"flex"},appBar:{zIndex:e.zIndex.drawer+1,backgroundColor:"#37ABA2"},drawer:{width:240,flexShrink:0},drawerPaper:{width:240},content:{flexGrow:1,padding:e.spacing(3)},toolbar:e.mixins.toolbar}}));function ie(){var e=ce(),t=r.a.useState(1),a=Object(s.a)(t,2),n=a[0],o=a[1];return r.a.createElement("div",{className:e.root},r.a.createElement(F.a,null,r.a.createElement(m.a,null),r.a.createElement(u.a,{position:"fixed",className:e.appBar},r.a.createElement(f.a,null,r.a.createElement(p.a,{variant:"h6",noWrap:!0},"LetsWalk CMS"))),r.a.createElement(i.a,{className:e.drawer,variant:"permanent",classes:{paper:e.drawerPaper}},r.a.createElement("div",{className:e.toolbar}),r.a.createElement(h.a,null,r.a.createElement(g.a,{button:!0,selected:1===n,onClick:function(e){o(1)},component:F.b,to:"/teamlist"},r.a.createElement(E.a,null,r.a.createElement(y.a,null)),r.a.createElement(v.a,null,"\u7d44\u968a\u5217\u8868")),r.a.createElement(d.a,null),r.a.createElement(d.a,null))),r.a.createElement("main",{className:e.content},r.a.createElement("div",{className:e.toolbar}),r.a.createElement("div",null,r.a.createElement(se.a,{exact:!0,path:"/",component:L}),r.a.createElement(se.a,{path:"/teamlist",component:L}),r.a.createElement(se.a,{path:"/teaminfo",component:ee}),r.a.createElement(se.a,{path:"/notification",component:le})))))}a(100);var ue=function(){return r.a.createElement(ie,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(ue,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},88:function(e,t,a){e.exports=a(101)},93:function(e,t,a){}},[[88,1,2]]]);
//# sourceMappingURL=main.e89ee70d.chunk.js.map